DROP TABLE colision;
DROP TABLE social;
DROP TABLE material;
DROP TABLE estado;
DROP TABLE siniestro;
DROP TABLE poliza;
DROP TABLE tarjeta;
DROP TABLE auto;
DROP TABLE cotizacion;
DROP TABLE cliente;

CREATE TABLE cliente(
rfc varchar(13) PRIMARY KEY,
nombre char(15) NOT NULL,
apPaterno char(15) NOT NULL,
apMaterno char(15) NOT NULL,
email varchar(35) NOT NULL,
direccion varchar(30) NOT NULL
);

CREATE TABLE cotizacion(
id_cotizacion number(4) PRIMARY KEY,
rfc varchar(13) NOT NULL REFERENCES cliente(rfc),
fecha varchar(8) NOT NULL,
estado char(4) NOT NULL,
codigoPostal number(5) NOT NULL,
edad number(2) NOT NULL,
total number(6,2) NOT NULL
);

CREATE TABLE auto(
id_auto number(4) PRIMARY KEY,
id_cotizacion number(4) NOT NULL REFERENCES cotizacion(id_cotizacion),
marca varchar(4) NOT NULL,
modelo varchar(6) NOT NULL,
anio number (4) NOT NULL
);

CREATE TABLE tarjeta(
numTarjeta number(16) PRIMARY KEY,
rfc varchar(13) NOT NULL REFERENCES cliente(rfc),
tipo varchar(10) NOT NULL,
expiracion number(4) NOT NULL,
numSeguridad number(3) NOT NULL
);

CREATE TABLE poliza(
folio varchar(13) PRIMARY KEY,
numTarjeta number(16) NOT NULL REFERENCES tarjeta(numTarjeta),
rfc varchar(13) NOT NULL REFERENCES cliente(rfc),
serieVehiculo number(13) NOT NULL,
placas varchar(7) NOT NULL,
fechaHoraInicio number(12) NOT NULL,
fechaHoraFin number(12) NOT NULL,
tipoSeguro char(2) NOT NULL
);

CREATE TABLE siniestro(
id_siniestro number(5) PRIMARY KEY,
folio varchar(13) NOT NULL REFERENCES poliza(folio),
numTarjeta number(16) NOT NULL REFERENCES tarjeta(numTarjeta),
rfc varchar(13) NOT NULL REFERENCES cliente(rfc),
fechaHora number(12) NOT NULL,
direccion varchar(25) NOT NULL,
descripcion varchar(20) NOT NULL
);

CREATE TABLE estado(
id_estado number(5) PRIMARY KEY,
estado varchar(10) NOT NULL,
id_siniestro number(5) NOT NULL REFERENCES siniestro(id_siniestro)
);

CREATE TABLE material(
id_siniestro number(5) NOT NULL REFERENCES siniestro(id_siniestro),
numReporte number(5) NOT NULL,
descripcion varchar(20) NOT NULL
);

CREATE TABLE social(
id_siniestro number(5) NOT NULL REFERENCES siniestro(id_siniestro),
numReporte number(5) NOT NULL,
ambulancia number(5) NOT NULL,
hospital varchar(20) NOT NULL,
direccion varchar(30) NOT NULL
);

CREATE TABLE colision(
id_siniestro number(5) NOT NULL REFERENCES siniestro(id_siniestro),
marcaInvolucrado1 varchar(10) NOT NULL,
modeloInvolucrado1 varchar(10) NOT NULL,
numReporte number(5) NOT NULL,
numSerie number(13) NOT NULL,
poliza varchar(13) NOT NULL REFERENCES poliza(folio)
);

INSERT INTO cliente
VALUES ('AEGP8010052H3','Paul','Anderson','Gough','ptanderson@prebesafe.com','Central Park Av 3554');

INSERT INTO cliente
VALUES ('AAFM811126LX2','Madali','Alvarez','Fuentes','madali.alvarez@prebesafe.com','Av Independencia 3554');

INSERT INTO cliente
VALUES ('JIJE801102L43','Elizabeth','Jimenez','Jimenez','elizabeth.jimenez@prebesafe.com','Calle Aldama 50');

INSERT INTO cliente
VALUES ('JILA5405241VL','Alejandro','Lopez','Jimenez','alejandro.lopez@prebesafe.com','Av 5 de Mayo 1320');

INSERT INTO cliente
VALUES ('LOBG81122676R','Gonzalo','Lopez','Bartolo','gonzalo.lopez@prebesafe.com','Benito Juarez 495');

INSERT INTO cliente
VALUES ('PIPA841207GB2','Alfredo','Pinzon','Prado','alfredo.pinzon@prebesafe.com','Av 20 de Noviembre 795');

INSERT INTO cliente
VALUES ('RARE79081269F','Ethel','Ramirez','Rodriguez','ethel.ramirez@prebesafe.com','Hidalgo 40');

INSERT INTO cliente
VALUES ('LORD620804HU5','Dominga','Lopez','Ramirez','dominga.lopez@prebesafe.com','Ocampo 38');

INSERT INTO cliente
VALUES ('LOVE8412012ZW','Elsy','Lopez','Vega','elsy.lopez@prebesafe.com','Matamoros 225');

INSERT INTO cliente
VALUES ('METO880902FA3','Otniel','Melendez','Teran','otniel.melendez@prebesafe.com','Nicolas Bravo 1270');

INSERT INTO cliente
VALUES ('MIAR880819C3N','Rosalva','Miguel','Avendano','rosalva.miguel@prebesafe.com','Ignacio Zaragoza 303');

INSERT INTO cliente
VALUES ('PALA840714ARN','Alfredo','Pacheco','Laurean','alfredo.pacheco@prebesafe.com','Aldama 1212');

INSERT INTO cliente
VALUES ('SACA810227E23','Adrian','Santiago','Cruz','adrian.santiago@prebesafe.com','Francisco I Madero 182');

INSERT INTO cliente
VALUES ('MUTE760507K7S','Edson','Munoz','Trujillo','edson.munoz@prebesafe.com','Libertad 1046');

INSERT INTO cliente
VALUES ('COCO800502MBR','Octavio','Corres','Corro','octavio.corres@prebesafe.com','Reforma 222');

INSERT INTO cotizacion
VALUES (0001, 'AEGP8010052H3', '20150224', 'NL', 14532, 35, 1949.99);

INSERT INTO cotizacion
VALUES (0002, 'AAFM811126LX2', '20151019', 'CHIH', 31200, 24, 949.99);

INSERT INTO cotizacion
VALUES (0003, 'JIJE801102L43', '20151224', 'GTO', 25468, 19, 4239.99);

INSERT INTO cotizacion
VALUES (0004, 'JILA5405241VL', '20160210', 'JAL', 44280, 48, 699.49);

INSERT INTO cotizacion
VALUES (0005, 'LOBG81122676R', '20151120', 'CDMX', 01520, 36, 1499.99);

INSERT INTO cotizacion
VALUES (0006, 'PIPA841207GB2', '20140515', 'NL', 14432, 22, 2999.99);

INSERT INTO cotizacion
VALUES (0007, 'RARE79081269F', '20150430', 'SON', 65268, 56, 949.99);

INSERT INTO cotizacion
VALUES (0008, 'LORD620804HU5', '20150224', 'CDMX', 04650, 35, 1749.99);

INSERT INTO cotizacion
VALUES (0009, 'LOVE8412012ZW', '20161010', 'TPS', 78594, 35, 1901.99);

INSERT INTO cotizacion
VALUES (0010, 'METO880902FA3', '20141214', 'TPS', 77958, 35, 4949.99);

INSERT INTO cotizacion
VALUES (0011, 'MIAR880819C3N', '20101004', 'VER', 14874, 35, 609.99);

INSERT INTO cotizacion
VALUES (0012, 'PALA840714ARN', '20161020', 'JAL', 44965, 35, 2000.00);

INSERT INTO cotizacion
VALUES (0013, 'SACA810227E23', '20150506', 'PUE', 25421, 35, 7899.99);

INSERT INTO cotizacion
VALUES (0014, 'MUTE760507K7S', '20130729', 'JAL', 43650, 35, 1309.99);

INSERT INTO cotizacion
VALUES (0015, 'COCO800502MBR', '20120330', 'OAX', 84652, 35, 1299.99);

INSERT INTO auto
VALUES (1001, 0001, 'CHE', 'AVEO', 2011);

INSERT INTO auto
VALUES (1002, 0002, 'AU', 'A3', 2016);

INSERT INTO auto
VALUES (1003, 0003, 'NIS', 'TSURU', 2010);

INSERT INTO auto
VALUES (1004, 0004, 'NIS', 'ALTIMA', 2008);

INSERT INTO auto
VALUES (1005, 0005, 'CHE', 'SPARK', 2012);

INSERT INTO auto
VALUES (1006, 0006, 'FORD', 'FIESTA', 2009);

INSERT INTO auto
VALUES (1007, 0007, 'FORD', 'FOCUS', 2012);

INSERT INTO auto
VALUES (1008, 0008, 'FORD', 'F150', 2005);

INSERT INTO auto
VALUES (1009, 0009, 'HON', 'CIVIC', 2016);

INSERT INTO auto
VALUES (1010, 0010, 'CHE', 'SONIC', 2011);

INSERT INTO auto
VALUES (1011, 0011, 'NIS', 'MARCH', 2015);

INSERT INTO auto
VALUES (1012, 0012, 'AU', 'A1', 2014);

INSERT INTO auto
VALUES (1013, 0013, 'BMW', 'Z3', 2011);

INSERT INTO auto
VALUES (1014, 0014, 'SEAT', 'IBIZA', 2013);

INSERT INTO auto
VALUES (1015, 0015, 'CHRY', 'AVEO', 2009);

INSERT INTO tarjeta
VALUES (4152313052462091, 'AEGP8010052H3', 'VISA', 1019, 390);

INSERT INTO tarjeta
VALUES (4152311456923168, 'AAFM811126LX2', 'VISA', 0222, 285);

INSERT INTO tarjeta
VALUES (5250351456489646, 'JIJE801102L43', 'MASTERCARD', 0617, 454);

INSERT INTO tarjeta
VALUES (4153185684968536, 'JILA5405241VL', 'VISA', 0625, 154);

INSERT INTO tarjeta
VALUES (5214685465168746, 'LOBG81122676R', 'MASTERCARD', 1216, 845);

INSERT INTO tarjeta
VALUES (1564965165496856, 'PIPA841207GB2', 'AMEX', 0520, 945);

INSERT INTO tarjeta
VALUES (5248165165468516, 'RARE79081269F', 'MASTERCARD', 0218, 158);

INSERT INTO tarjeta
VALUES (4152312887956857, 'LORD620804HU5', 'VISA', 1230, 465);

INSERT INTO tarjeta
VALUES (1156448946541323, 'LOVE8412012ZW', 'AMEX', 0719, 136);

INSERT INTO tarjeta
VALUES (1854652132165466, 'METO880902FA3', 'AMEX', 1019, 784);

INSERT INTO tarjeta
VALUES (1898766531355488, 'MIAR880819C3N', 'AMEX', 0819, 498);

INSERT INTO tarjeta
VALUES (4152314984656548, 'PALA840714ARN', 'VISA', 1224, 189);

INSERT INTO tarjeta
VALUES (5248165165464854, 'SACA810227E23', 'MASTERCARD', 0322, 752);

INSERT INTO tarjeta
VALUES (5248145646851656, 'MUTE760507K7S', 'MASTERCARD', 0624, 168);

INSERT INTO tarjeta
VALUES (1564896532165324, 'COCO800502MBR', 'AMEX', 1118, 354);

INSERT INTO poliza
VALUES ('KJLHFDSLI1548', 4152313052462091, 'AEGP8010052H3', 8646848964865, 'EGV4582', 201502241130, 201802241130, 'CA');

INSERT INTO poliza
VALUES ('KJLHFDSLI1550', 4152311456923168, 'AAFM811126LX2', 8646848964875, 'HUF4652', 201610010700, 202010010700, 'CB');

INSERT INTO poliza
VALUES ('KJLHFDSLI1552', 5250351456489646, 'JIJE801102L43', 8646848964886, 'MMM9875', 201306281530, 201706281530, 'CP');

INSERT INTO poliza
VALUES ('KJLHFDSLI1554', 4153185684968536, 'JILA5405241VL', 8646848964896, 'WOW1285', 201007111000, 202007111000, 'CB');

INSERT INTO poliza
VALUES ('KJLHFDSLI1556', 5214685465168746, 'LOBG81122676R', 8646848964898, 'LOL7854', 201610021700, 201810021700, 'CA');

INSERT INTO poliza
VALUES ('KJLHFDSLI1558', 1564965165496856, 'PIPA841207GB2', 8646848964905, 'WEX5736', 201508050900, 201808050900, 'CP');

INSERT INTO poliza
VALUES ('KJLHFDSLI1559', 5248165165468516, 'RARE79081269F', 8646848964907, 'HTM4875', 201610051100, 201810051100, 'CB');

INSERT INTO poliza
VALUES ('KJLHFDSLI1560', 4152312887956857, 'LORD620804HU5', 8646848964915, 'PHP9563', 201608011500, 201808011100, 'CA');

INSERT INTO poliza
VALUES ('KJLHFDSLI1561', 4152313052462091, 'LOVE8412012ZW', 8646848964918, 'MRL7961', 201601051600, 201801051600, 'CB');

INSERT INTO poliza
VALUES ('KJLHFDSLI1562', 4152313052462091, 'METO880902FA3', 8646848964922, 'OMG2014', 201407171800, 202207171800, 'CP');

INSERT INTO poliza
VALUES ('KJLHFDSLI1564', 4152313052462091, 'MIAR880819C3N', 8646848964923, 'MUR4894', 201503041900, 202003041900, 'CB');

INSERT INTO poliza
VALUES ('KJLHFDSLI1566', 4152313052462091, 'PALA840714ARN', 8646848964930, 'RLD2256', 201207191200, 202507191200, 'CA');

INSERT INTO poliza
VALUES ('KJLHFDSLI1568', 4152313052462091, 'SACA810227E23', 8646848964938, 'MRU7943', 200905151800, 201905151800, 'CP');

INSERT INTO poliza
VALUES ('KJLHFDSLI1570', 4152313052462091, 'MUTE760507K7S', 8646848964940, 'THC6545', 201610091530, 202110091530, 'CP');

INSERT INTO poliza
VALUES ('KJLHFDSLI1575', 4152313052462091, 'COCO800502MBR', 8646848964941, 'POP2996', 201110291130, 201610291130, 'CA');

INSERT INTO siniestro
VALUES (30001, 'KJLHFDSLI1548', 4152313052462091, 'AEGP8010052H3', 201602151345, 'Tlalpan 1560', 'Choque menor');

INSERT INTO siniestro
VALUES (30002, 'KJLHFDSLI1550', 4152311456923168, 'AAFM811126LX2', 201610021532, 'Insurgentes 2500', 'Carambola');

INSERT INTO siniestro
VALUES (30003, 'KJLHFDSLI1552', 5250351456489646, 'JIJE801102L43', 201602211414, 'Reforma 234', 'Choque con MB');

INSERT INTO siniestro
VALUES (30004, 'KJLHFDSLI1554', 4153185684968536, 'JILA5405241VL', 201509090909, 'Cjon Esfuerzo 14', 'Choque con barda');

INSERT INTO siniestro
VALUES (30005, 'KJLHFDSLI1556', 5214685465168746, 'LOBG81122676R', 201610151057, 'Calzada Acoxpa 10', 'Choque menor');

INSERT INTO siniestro
VALUES (30006, 'KJLHFDSLI1558', 1564965165496856, 'PIPA841207GB2', 201510091658, 'Canal de Miramontes 515', 'Atropellado');

INSERT INTO siniestro
VALUES (30007, 'KJLHFDSLI1559', 5248165165468516, 'RARE79081269F', 201610102023, 'Periferico 4091', 'Incendio de coche');

INSERT INTO siniestro
VALUES (30008, 'KJLHFDSLI1560', 4152312887956857, 'LORD620804HU5', 201609191957, 'Reforma 1754', 'Llanta ponchada');

INSERT INTO siniestro
VALUES (30009, 'KJLHFDSLI1561', 4152313052462091, 'LOVE8412012ZW', 201605101545, 'Sn Juan de Aragon 14', 'Atropellado');

INSERT INTO siniestro
VALUES (30010, 'KJLHFDSLI1562', 4152313052462091, 'METO880902FA3', 201504111647, 'Paseo del Pedregal 420', 'Volcadura');

INSERT INTO siniestro
VALUES (30011, 'KJLHFDSLI1564', 4152313052462091, 'MIAR880819C3N', 201504280234, 'Agua 35', 'Choque con poste');

INSERT INTO siniestro
VALUES (30012, 'KJLHFDSLI1566', 4152313052462091, 'PALA840714ARN', 201311150331, 'Pino 29', 'Choque con casa');

INSERT INTO siniestro
VALUES (30013, 'KJLHFDSLI1568', 4152313052462091, 'SACA810227E23', 201010140849, 'Michoacan 26', 'Volcadura');

INSERT INTO siniestro
VALUES (30014, 'KJLHFDSLI1570', 4152313052462091, 'MUTE760507K7S', 201610150655, 'Tlapacoya 46', 'Robo');

INSERT INTO siniestro
VALUES (30015, 'KJLHFDSLI1575', 4152313052462091, 'COCO800502MBR', 201404050607, 'Jose Rocabruna 11', 'Robo');

INSERT INTO estado
VALUES (50001, 'REGISTRADO', 30001);

INSERT INTO estado
VALUES (50002, 'CONCLUIDO', 30002);

INSERT INTO estado
VALUES (50003, 'CONCLUIDO', 30003);

INSERT INTO estado
VALUES (50004, 'CANCELADO', 30004);

INSERT INTO estado
VALUES (50005, 'ATENDIDO', 30005);

INSERT INTO estado
VALUES (50006, 'CONCLUIDO', 30006);

INSERT INTO estado
VALUES (50007, 'EN PROCESO', 30007);

INSERT INTO estado
VALUES (50008, 'EN PROCESO', 30008);

INSERT INTO estado
VALUES (50009, 'CONCLUIDO', 30009);

INSERT INTO estado
VALUES (50010, 'ATENDIDO', 30010);

INSERT INTO estado
VALUES (50011, 'CANCELADO', 30011);

INSERT INTO estado
VALUES (50012, 'CONCLUIDO', 30012);

INSERT INTO estado
VALUES (50013, 'REGISTRADO', 30013);

INSERT INTO estado
VALUES (50014, 'CONCLUIDO', 30014);

INSERT INTO estado
VALUES (50015, 'ATENDIDO', 30015);

INSERT INTO colision
VALUES(30001, 'FORD', 'FOCUS', 40001, 6584985165498, 'KJLHFDSLI1548');

INSERT INTO colision
VALUES(30002, 'CHE', 'CAVALLIER', 40002, 5165661489445, 'KJLHFDSLI1550');

INSERT INTO material
VALUES (30003, 40003, 'Choque con MB');

INSERT INTO material
VALUES (30004, 40004, 'Choque con barda');

INSERT INTO colision
VALUES (30005, 'MTBS', 'OUTLANDER', 40005, 5165989445156, 'KJLHFDSLI1556');

INSERT INTO social
VALUES (30006, 60001, 15968, 'Hospital Angeles','Periferico 4500');

INSERT INTO material
VALUES (30007, 40006, 'Incendio de coche');

INSERT INTO material
VALUES (30008, 40007, 'Llanta ponchada');

INSERT INTO social
VALUES (30009, 60002, 15874, 'Hospital San Angel', 'Yucatan 167');

INSERT INTO material
VALUES (30010, 40008, 'Volcadura');

INSERT INTO material
VALUES (30011, 40009, 'Choque con poste');

INSERT INTO material
VALUES (30012, 40010, 'Choque con barda');

INSERT INTO material
VALUES (30013, 40011, 'Volcadura');

INSERT INTO material
VALUES (30014, 40012, 'Robo');

INSERT INTO material
VALUES (30015, 40013, 'Robo');

CREATE OR REPLACE VIEW vista1 AS
SELECT id_cotizacion, rfc, fecha, estado, codigoPostal, edad, total FROM cotizacion
WHERE total > 1900;
SELECT * FROM vista1;

CREATE OR REPLACE VIEW vista2 AS
SELECT folio, rfc, placas, TO_CHAR(fechaHoraInicio, '999999999999') AS Inicio, TO_CHAR(fechaHoraFin, '999999999999') AS Fin FROM poliza
WHERE fechaHoraInicio > 201610000000;
SELECT * FROM vista2;

CREATE OR REPLACE VIEW vista3 AS
SELECT folio, rfc, placas FROM poliza
where folio in (
	SELECT folio FROM siniestro
	where id_siniestro in (
		SELECT id_siniestro from estado
		where estado = 'REGISTRADO'
	)
);
SELECT * FROM vista3;

CREATE OR REPLACE VIEW vista4 AS
SELECT nombre, apPaterno, apMaterno, rfc FROM cliente
WHERE rfc in (
	SELECT rfc FROM poliza
	WHERE ((tipoSeguro = 'CA') AND (fechaHoraInicio < 201610000000))
);
SELECT * FROM vista4;

CREATE OR REPLACE VIEW vista5 AS
SELECT hospital FROM social
where id_siniestro in (
	SELECT id_siniestro FROM siniestro
	WHERE folio in (
		SELECT folio FROM poliza
		WHERE fechaHoraFin < 202408000000
	)
);
SELECT * FROM vista5;